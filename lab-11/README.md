# A. Борьба за сахар
Сидит жадина с килограммом конфет, шуршит фантиками, и никого рядом нет. Скучно ей одной, неинтересно совсем, поэтому она решила начать играть с конфетами.

Она нарисовала себе поле $N×M$ клеток, зачеркнула $Q$ из них и начала раскладывать прямоугольные конфеты размера $2×1$ по клеточкам таким образом, чтобы зачёркнутые клетки остались непокрытыми, а конфеты не лежали друг на друге.

Жадина предложила вам поиграть с ней, разложить конфеты по полю, соблюдая все правила. После этого она готова будет отдать вам все разложенные конфеты. Постарайтесь выиграть как можно больше сладостей.

Входные данные

В первой строке даны два целых числа $N, M$ (1≤N,M≤100)$.
Во второй строке целое число $Q$.
В следующих $Q$ строках записаны координаты зачеркнутой клетки $x, y$ $(1≤x≤N, 1≤y≤M)$.

Выходные данные

Выведите максимальное количество клеток, которое вы сможете покрыть конфетами.

# B. Шёпот далёких звёзд
Черная Дыра взяла под контроль систему
И поглощает плач согласно поточной лемме,
Создавая липкий ужас, который вскоре
Каждый человек испытает собственной шкурой.

Произошла метаморфоза: звезды - теперь вершины,
Направляющие ужас и слезы между чужими.
Тут вершины горят.
А между ними липкий ужас, да такой, что предпочтительнее ад.

И тут точно не может быть мало места
Тьма нескончаемая, но чую то, что мне тесно.
Что-то не так, кроме задач:
Ты ощущаешь трепет, заставляет он считать тебя всемирный плач.

Звезды соединены потоками вот такими:
Направляют они слезы до Черной Дыры с Земли.
И вас тянет считать
Сколько же всего может Дыра та получать?

Отвечайте зеркалу на запросы
Воспринимайте потоки только всерьез и
Осознавайте, что не вернете слёз,
Падающих по вам, под шёпот далёких звёзд.

Входные данные

В первой строке записаны два натуральных числа $N$ и $M$ - количество звезд и количество связей между ними. $(1 ≤ N, M ≤ 10^4)$.
Далее в $M$ строках передаются 3 числа: Исходный небесный объект $(1 ≤ u ≤ N)$, конечный небесный объект $1 ≤ v ≤ N$, и пропускная способность звездных потоков $(0 < c ≤ 10^2)$.

$1$ всегда Земля, $N$ - всегда Черная Дыра.

Выходные данные

Натуральное число $K$ - максимальное количество слез, которое может получить Черная Дыра.

# C. А можно я с тобой?
Рыжий котёнок Кузя прогуливался по Санкт-Петербургу. Малыш любовался его архитектурой, реками, каналами, разводными мостами, в общем жил свою лучшую кошачью жизнь. Ничего не предвещало беды, как вдруг он понял, что потерялся. Вокруг были только какие-то странные и незнакомые дома. Кузя добрёл до трамвайных путей и засмотрелся на здание напротив. Его внимание привлекла башня, а именно свет из её окон. "Наверное, там очень тепло и уютно", - подумал Кузя. Он сразу решил, что сделает всё возможное и невозможное, дабы попасть туда. Кузя оббежал здание со всех сторон, и вдруг прям у входа встретил большую чёрную кошку, она представилась ему как Люси. Она выглядела очень опрятно на фоне маленького рыжего бродяги.

Люси рассказала, что просто так в эту башню котят не пускают, нужно обязательно сдать кошачий экзамен по алгоритмам. Начать она ему посоветовала с поиска максимального паросочетания в схеме того самого здания. Искать нужно в такой комбинации его коридоров, которая позволит обойти все аудитории, и при этом по суммарной протяжённости всех коридоров будет минимальной из возможных. Люси не смогла предоставить схему, ведь у неё лапки, но сказала, что в здании $M$ коридоров и $N$ аудиторий, а также назвала целых $M$ наборов из трёх чисел: $A, B$ и $C$, которые означают, что в здании существует коридор между аудиториями $A$ и $B$ длины $C$. Максимальным считается такое паросочетание, в котором суммарная длина всех коридоров максимальна.

Люси начала уходить, а Кузя кричал ей вслед: "Постой, можно я с тобой?". Грациозная кошка сказала, что если малыш сумеет найти максимальное паросочетание, то она заберёт его, и они вместе будут жить в той самой башне. А пока ему придётся жить одному на улицах, которые он совсем не знает. Трудные времена рождают сильных котят, помогите Кузе исполнить мечту, найдите максимальное паросочетание в схеме коридоров.

Входные данные

Первая строка входных данных содержит два числа: $N$ и $M$, количество аудиторий и коридоров соответсвенно $(3≤N≤10^5, 2≤M≤10^6)$.

В следующих $M$ строках содержится описание коридоров: $A_{i}, B_{i}$ и $C_{i}$, где $A_{i}$ и $B_{i}$ - связанные этим коридором аудитории, а $C_{i}$ - его длина.

Выходные данные

Необходимо вывести одно число: суммарную протяженность всех коридоров в максимальном паросочетании.

# D. Я не продаюсь, но...
Даша никак не могла найти себе подходящего котёнка, поэтому решила пойти на специальное шоу по подбору питомцев "За корм и игрушки да". В шоу принимают участие $N$ котят и $N$ потенциальный хозяев (все пронумерованы от $0$ до $N−1$). Каждый котёнок предполагает, сколько денег есть у каждого потенциального хозяина на корм и игрушки, и записывает лапками себе в блокнот номера хозяев, в порядке убывания предполагаемого количества средств на содержание питомца. Далее каждый хозяин оценивает своё желание забрать конкретного котёнка, после чего записывает номера котят в порядке убывания своего желания.

Все участники шоу пришли туда с серьёзными намерениями, поэтому нестабильные пары питомцев и хозяев им не нужны. Если существуют пары $(w_{i}, m_{j})$ и $(w_{k}, m_{l})$ и котёнок $w_{i}$ считает, что у $m_{l}$ денег на содержание больше, чем у $m_{j}$, а $m_{l}$ хочет подарить игрушки и корм котёнку с номером $w_{i}, больше, чем котёнку с номером $w_{k}$, то эти пары считаются нестабильными.

Вы являетесь организатором этого шоу и перед вами стоит задача: распределить всех участников и котят в стабильные пары. При распределении предпочтения котят являются приоритетнее предпочтений потенцияльных хозяев.

Входные данные

В первой строке дано целое число $N (1≤N≤1500)$.

В следующих $N$ строках описаны предпочтения котят. В $i$-той строке предпочтения $i$-того котёнка: $N$ чисел подряд - уникальные номера хозяев в порядке убывания предполагаемого этим котёнком количества денег на содержание питомца.

В следующих $N$ строках аналогично описаны предпочтения хозяев.

Выходные данные

Выведите все пары, получившиеся в результате этого шоу в формате $(w,m)$, где $w$ - номер котёнка, $m$ - номер хозяина. Пары необходимо отсортировать по номеру котёнка.

# E. La Seine
Однажды два музыканта отправились в Париж, чтобы провести концерт. Они решили, что для привлечения внимания к их дуэту стоит разработать особый маршрут, по которому будет ездить фургон с их музыкой.

Было принято решение передвигаться таким образом, чтобы их музыку было слышно на каждом мосту города. По обе стороны от каждого моста расположены перекрёстки, на которых музыканты планируют делать остановки. Они уверены, что благодаря этой тактике слух о них будет распространяться по всем мостам, связанным с текущим перекрёстком. Также они решили, что между перекрёстками им следует передвигаться лишь по мостам, переезжая с одного берега на другой.

Музыканты изучили карту города и обнаружили, что на каждом берегу реки Сена имеется своя собственная нумерация перекрестков: на левом берегу они нумеруются от $1$ до $N$, а на правом – от $1$ до $K$. Оказалось, что по законам Парижа за несогласованную рекламу на перекрёстках придётся заплатить. У героев и так немного денег, помогите бедным музыкантам найти минимальный набор перекрёстков, останавливаясь лишь на которых, их музыку услышат на каждом мосту города.

Входные данные

В первой строке записаны три целых числа: $N, K$ и $M$, где $M$ − колличество мостов $(0≤N,K≤2⋅10^3;M≤N⋅K)$.

В следующих $M$ строках находятся два числа: $L_{i}$ и $R_{i}$ - номера перекрёстков по левую и правую сторону реки соответственно, которые соединяет $i$-ый мост $(1≤L_{i},R_{i}≤2⋅10^3)$.

Выходные данные

В первой строке необходимо вывести количество выбранных перекрёстков на левом берегу. Во второй $−$ их номера.

В третьей строке следует вывести количество выбранных перекрёстков на правом берегу. В четвёртой $−$ их номера.

# F. Летняя тоска Светланы
В преддверии выпуска нового альбома, известная певица Светлана де Роуз готовится к запуску продаж эксклюзивных виниловых пластинок. Для оптимальной транспортировки продукции ей необходимо найти наиболее эффективный маршрут в транспортной сети своей страны, в которой, к слову, $M$ дорог и $N$ городов.

Производство винила расположено в городе $s$. Довести весь товар необходимо до города $t$. Для каждой дороги определены её пропускная способность, равная $c$, и стоимость перевозки товара по ней, равная $p$.

Важно не только найти максимальный поток, но и минимизировать затраты на всю перевозку. У Светланы небольшой опыт в логистике, поэтому она обратилась к Вам — лучшему программисту страны, чтобы именно Вы помогли ей найти наибольший поток из города $s$ в город $t$ с наименьшей стоимостью.

Входные данные

В первой строке содержатся четыре числа: $N(N≤2000)$, $M(M≤N(N−1)/2)$, $s$ и $t$ - количество городов, дорог, номера городов $s$ и $t$ соответсвенно.

В каждой из следующих $M$ строк находится описание дорог: $u_{i}, v_{i}, c_{i}$ и $p_{i}$, где $u_{i}$ и $v_{i}$ - связанные этой дорогой города, $c_{i}$ - пропускная способность дороги, а $p_{i}$ - стоимость перевоза винила по ней $(u_{i},v_{i}≤N;c_{i},p_{i}≤1000)$.

Выходные данные

Через пробел выведите два числа: максимальный поток и его минимальную стоимость.

# G. Нighway of a lifetime
По горной дороге ехал мотоциклист Ангус. По мере того, как мотоциклист прибавлял газ, разные мысли начинали появляться в его голове, но все воспоминания были спутаны.

Ангус решил, что он хочет упорядочить их таким образом, чтобы они выстроились в единый цикл, цикл всей его жизни. Каждое воспоминание в этом цикле должно встретиться лишь единожды. Помогите мотоциклисту упорядочить воспоминания и выведите их.

Входные данные

Первая строка входных данных содержит два числа: $N$ и $M$, количество воспоминаний и связи между ними соответсвенно $(3≤N≤10^5, 2≤M≤10^6)$.

В следующих $M$ строках содержится описание воспоминаний: $A_{i}, B_{i}$, где $A_{i}$ и $B_{i}$ - связанные воспоминания. $0≤A_{i},B_{i}≤N−1$

Выходные данные

Необходимо вывести цикл из воспоминаний.