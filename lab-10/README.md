# A. АРАТАКИ РЕЙГЕН
Его зовут Кагеяма Шигео. Его прозвище - Моб. Он настоящий экстрасенс, ученик ВЕЛИЧАЙШЕГО ЭКСТРАСЕНСА 21 ВЕКА РЕЙГЕНА АРАТАКИ. На его лице вы вряд-ли увидите эмоции, но за таким неприметным парнишкой стоит огромная сила. Иногда, когда эмоции переполняют Моба, он выпускает всю свою экстрасенсорную неконтролируемую силу наружу и может навредить людям вокруг.

Но я, Великий учитель Моба РЕЙГЕН АРАТАКИ, научил моба своему невероятному приёму:

Секретное очищающее зло экстрасенсорное изгнание кодом Прюфера $(プルーファーコードによる秘密の浄化邪悪な精神的な追放)$

Его суть проста, может даже вы, смертные, сможете его освоить. Я рисую Мобу дерево, а он превращает его в последовательность чисел.

Входные данные

В первой строке два числа $n (3≤n≤5⋅10^5)$ - количество вершин в дереве, $m$ - количество рёбер в дереве.
Далее идут $m (2≤m≤5⋅10^5)$ строк с описанием рёбер, в каждой из которых по два числа $u, v, (1≤u,v≤n)$

Выходные данные

Выведите $n−2$ чисел - код Прюфера дерева.

# B. Истребители демонов
Наших трех героев - Камабоко Гонпачиро, Зеницу и Иноске отправили на задание: им необходимо победить опасного демона - 6 высшую луну.

Герои шли по мрачному лесу, прислушывались к посторонним звукам, и вдруг Танджиро учуял отвратительный запах демона. Это могло значить только одно: команда идёт в нужном направлении. Они ускорились и побежали вслед за источником запаха.

Вскоре герои увидели разрушенную деревушку, из которой доносились душераздирающие крики. Стало понятно, что в этом замешан демон прошлого - ёкай, который лакомится людьми.

Теперь появилась задача сильно важнее уничтожения демона: спасение людей, которые прятались по своим домам и от страха не могли даже шагу сделать. Наша команда решила, что лучшим решением будет увести всех выживших в безопасное место.

Герои просят вашей помощи: найдите такую комбинацию дорог, следуя по которым они смогут посетить все дома и следовательно увести всех жителей (суммарная протяженность всех тропинок должна быть минимальной).

Входные данные

В первой строке даны два натуральных числа $N$ и $M$ – количество домов и тропинок между ними соответственно $(3≤N≤100,N≤M≤N(N−1)/2)$

В каждой из следующих $M$ строк находятся по три целых числа: 
$A_{i}, B_{i}, C_{i}$, где $C_{i}$ – протяженность дороги между домами $A_{i}$ и $B_{i}$ $(1≤Ci≤100000;i=1,2,…,N)$.

Выходные данные

Выведите одно число - минимальную суммарную протяженность всех дорог в найденной комбинации.

# C. Ведьмина служба доставки
Кики - юная ведьма, которой только исполнилось 13 лет, и вскоре в её жизни начнётся новый важный этап: девочке предстоит стажировка. Она проведёт целый год вдали от дома, в Корико, где придётся жить за счёт предоставления горожанам своих профессиональных ведьминских услуг.

Как оказалось, Кирико - огромный мегаполис, и разбираться в устройстве всех его запутанных улочек - та ещё морока. Времени до переезда остаётся всё меньше и меньше, поэтому Кики старается распланировать всё до мельчайших подробностей. Волшебница уже собрала все баночки, скляночки, все магические травы и книжки, всё необходимое для любимого котёнка, но вот незадача, как же рассказать всем жителям Кирико о своих услугах?

Нашей юной ведьме сильно повезло, ведь в том городе у неё был знакомый картограф, и как только он узнал, что Кики собирается провести целый год в Корико, незамедлительно отправил ей карту города: он изобразил все дома, все связывающие их дороги, и для каждой указал протяженность. Безусловно, разбираться в этой запутанной схеме самостоятельно невозможно, да ещё и успеть всё до поездки..Кики снова обратилась за помощью. Девочка хочет найти в этом городе такой маршрут, который позволит ей обойти всех жителей, и при этом он должен быть минимальным из возможных. Помогите юной волшебнице справиться с этой задачей.

Входные данные

В первой строке содержатся два числа: $N$ и $M$ - количество домов и дорог между ними соответственно $(3≤N≤10^5, M≤10^6)$.
В следующих $M$ строках содержится по три числа: $a_{i}, b_{i}, l_{i}$ где $− a_{i} и b_{i} −$ дома, которые соединяет $i$-ая дорога, а $l_{i} −$ её протяженность $(1≤l_{i}≤10^5)$.

Выходные данные

Выведите одно число $−$ минимальную протяженность маршрута, который позволит Кики обойти все дома.

# D. Очень яблок хочется...
Последнюю неделю Рюк только то и делал, что мечтал о яблоках, но как он ни старался их найти, у него всё никак не получалось. Ежедневно он ходил в 2-3 овощные лавки, после чего возвращался домой, но то он приходил туда слишком поздно, и все яблоки уже раскупали, то слишком рано, когда их ещё не успели завести. Любимых фруктов там никогда не было, да и магазинов в городе сильно больше. Вдоль каждой дороги между домами можно найти хотя бы одну, пусть даже крохотную, овощную лавку.

Рюк уверен, что ему точно удастся найти яблоки, если он пойдет по маршруту, который позволит ему обойти все 
M
M дорог города. При этом он хочет начать свой путь дома и закончить там же. Помогите Рюку заполучить желанные яблоки.

Входные данные

В первой строке содержатся два числа: $N$ и $M$ $-$ количество домов в городе и дорог, соединяющих их, соответственно $(1≤N≤5⋅10^5, 0≤M≤2⋅10^5)$.
Далее следуют $M$ строк, содержащих два числа: $a_{i}, b_{i} -$ описание $i$-ой дороги, которая соединяет дома $a_{i}$ и $b_{i}$.

Выходные данные

В одной строке выведите номера домов в том порядке, в котором их пройдёт Рюк. Если такого маршрута не существует, Рюк очень расстроится, выведите :(

# E. Грязные делишки
Пришел в замок дух помоек, и поручили Тихиро позаботиться о нем. Она сразу поняла, что обычной ванны недостаточно, чтобы очистить его, и нужно будет приготовить настой. Чтобы его приготовить, необходимо найти специальную табличку и отправить её господину Камадзи.

Замок устроен таким образом, что все переходы из комнаты в комнату представляют собой крутые и скользкие лестницы. Тихиро находится в комнате $a$, а нужная ей табличка в комнате $b$. Для того, чтобы сделать настой, ей надо добежать до комнаты $b$ и вернуться обратно (отправить табличку она сможет только из комнаты $a$). Но вот незадача, дух помоек решил везде ходить за ней, а после того как он прошёл по лестнице, снова по ней пройти было уже невозможно из-за количества грязи, которое осталось после него.

Помогите Тихиро найти ответы на $Q$ вопросов: выяснить, сможет ли она при таком расположении комнат $a$ и $b$ найти табличку и отправить её господину Камадзи.

Входные данные

В первой строке даны три целых числа $N$ - максимальный номер комнаты в замке (нумерация комнат начинается с нуля, их количество $- N+1$), $M$ - количество лестниц между ними, $Q$ - количество запросов $(1≤N≤10^3, 1≤M≤10^6, 0≤Q≤10^5)$.

В следующих $M$ строках находятся описания лестниц: $x$ и $y$ - номера комнат, между которыми есть лестница $(0≤x,y≤N,x≠y)$

В следующих $Q$ строках даны два целых числа $a$ - номер комнаты, в которой находится Тихиро и $b$ - номер комнаты, в которой лежит нужная табличка $(0≤a,b≤N)$.

Выходные данные

На каждый вопрос Тихиро выведите $YES$ если она сможет найти табличку и отправить её дедушке Камадзи и $NO$, если не сможет.

# F. Результат двух миллионов лет работы
Спустя 3 тысячи лет после каменной катастрофы, человечество потеряло цивилизацию. Молодой ученый Сенку, с которого довольно рано сошел каменный покров, нашел деревню, которая с нуля развивалась на протяжении 3 тысяч лет. Перед ним стояла сложная задача: заставить людей, которые никогда не видели цивилизации, поверить в науку. Вместе с любопытным пареньком Хромом они решили, что должны вылечить жрицу этой деревни от смертельной болезни, приготовив антибиотик.

Сенку знал, как добыть все необходимые материалы и что с ними делать, но это долгий процесс, для которого требуется множество различных мастерских для обработки и работы с различного рода веществами. Все мастерские были построены недалеко от лабораторной и работа шла полным ходом, но из-за неаккуратности Хром уронил на траву опасный химикат, который быстро распространился по всей земле, где стояли мастерские. Из-за этого химиката ходить по траве теперь опасно.

Сенку дал 10 миллиардов процентов, что вы сможете найти такой способ построить дороги между мастерскими, чтобы можно было свободно перемещаться между ними (из любой мастерской можно попасть в любую другую, не обязательно за одну дорогу), при этом на строительство дорог вы потратите как можно меньше материалов.

Входные данные

В первой строке даны два натуральных числа $N$ и $M$ - количество мастерских и возможные прямые пути между ними соответственно. $(3≤N≤100;N≤M≤N⋅(N−1)/2)$.

В каждой из последующих $M$ строк находятся 3 целых числа: $A_{i}, B_{i}, C_{i}, где $C_{i} -$ количество материалов, которое потребуется для строительства дороги между мастерскими $A_{i}$ и $B_{i}$ $(1≤C_{i}≤300;i=1,2,...,N)$.

Выходные данные

Выведите два натуральных числа $S1$ и $S2$ - минимальные количества необходимых материалов, которые потребуются для того, чтобы построить различные дороги между мастерскими $(S1 <= S2)$.

# H. Мугивары
На Гранд Лайне из-за магнитных волн, создаваемых островами, обычный компас бесполезен. Но команда Мугивар нашла выход - они заполучили Лог Пос - особое устройство, которое указывет на остров, чьи Магнитные волны он ловит. С помощью него и несложных вычислений Нами узнала сколько островов вокруг них.

Также Нами, пробыв два года на небесном острове Погодии, узнала, что течения на Гранд Лайне не самые обычные, проффесор Хередас назвал их гипертечениями, они могут соединять сразу несколько островов, а не 2, как обычно. И из любого острова в гипертечении можно доплыть до любого другого в этом же гипертечении за одно и то же время.

И вот настал час воспользоваться своими знаниями. Мугивары совершили подвиг в стране Вано и отправляются дальше, прямиком на остров Эльбаф. Но им нужно торопиться и выбрать самый короткий путь до него. Номер страны Вано на новой карте мугивар $-1$.

Входные данные

На первой строке даны три числа $n$ - количество островов $(1≤n≤10^5)$, $m$ - количество течений $(0≤m≤2∗10^4)$, $k$ - номер острова Эльбаф $(1≤k≤n)$.

Далее на $m$ строках описаны течения, сначала подается $s_{i}$ $(2≤s _{i}≤10^7)$ - количество островов, которые соединяет течение и t_{i} $(0≤t_{i}≤10^7)$ - время, за которое Мугивары смогут проплыть по гипертечению. Далее на этой строке идут $s_{i}$ номеров островов, которые входят в это течение.

Выходные данные

Одно число $t$ - минимальное время, за которое Мугивары доберутся от Страны Вано до Эльбафа. В случае если добраться нельзя, выведите $-1$.