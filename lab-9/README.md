# A. Конец или Начало
"Я не могу молчать! Всё вокруг кажется нереальным, но в то же время каким-то слишком настоящим. Кажется, я теряю себя. Я помню, как они пришли ко мне. Они спрашивали про сейф, какой-то сейф с деньгами или секретами, они говорили очень странно. Они хотят украсть у меня что-то, определённо. Говорили, что хотят помочь мне, но я им не верю. Ощущение того, что всё это сон, не покидает меня. Я хочу знать, так ли это, хочу понять, кому нужен это сейф, секрет, тайна, да что бы там ни было, на самом деле. Сам я не смогу остановить "их", мне нужна помощь. Я не знаю, к кому мне обратиться, никто же не поверит мне. А если это на самом деле сон, а они им каким-то образом управляют, они же не дадут мне узнать этого! Не позволят! Всё, что я могу сейчас сделать, это оставить свои записи. Может Вы, заинтересованный читатель, именно Вы, читая сейчас эти строки, поймёте, как помочь мне. Даже если со мной уже что-то случилось, может Вы обезопасите других. Вероятно, они могут навредить и другим. Мне нужно всё обдумать. Если это странное ощущение не пройдёт, я продолжу писать, лишь бы кто-то нашел мои записи, лишь бы это было не зря."

"Я не знаю, сколько времени прошло. Кажется, что я только-только отложил свой блокнот, но чернила от ручки выцвели так, словно кто-то оставил его раскрытым под палящим солнцем на месяц, не меньше! Такого же не происходит в жизни! Или я схожу с ума? Мне не стоит оставлять свои записи где попало, если их увидит кто-то "лишний", они всё поймут. Они поймут, что я всё знаю."

"Всё становится более странным и пугающим. Я проснулся. Всё, что было раньше, действительно было сном! Но хорошие новости на этом заканчиваются. Я проснулся в новом сне. Ощущение всё то же, поменялось только окружение, моя одежда, но это не по-настоящему. Я не помню, как вышел из предыдущего сна, поэтому не понимаю, как провернуть этот трюк вновь. Кажется, стоит как-то структурировать свои записи, чтобы по ним Вы смогли помочь мне разобраться со всем."

"Хочу договориться с Вами, дорогой читатель, каждый новый сон я буду обозначать числом $A$. Если есть такой сон, в который я проснулся из сна $A$, давайте мы назовём его $B$, то сны $A$ и $B$ будут крепко связаны между собой. Но пусть это работает в обе стороны, пусть как $A$ связано с $B$, так и $B$ связано с $A$. Если в записях вдруг будет какая-то цепочка из сна $C$ в сон $D$, то назовём такие сны просто связанными, не крепко. В случае моего примера со снами $A$ и $B$ они тоже просто связаны, крепкую связь будем считать частным случаем обычной связи. Что с этим делать, я пока не придумал. Напишу здесь позже."

"Ситуация не лучше. Ни капельки. Я начинаю путаться во снах. Кажется, что тот сон, из которого я проснулся в этот, был связан с каким-то другим. Точно не с этим. Кажется, я знаю какая помощь мне нужна от Вас. Я хочу структурировать все эти связи, распутать это непонятную паутину. Я хочу, чтобы Вы отвечали на запросы:

* $? A B$ (тогда Вам нужно ответить, связаны ли сны $A$ и $B$)
* $− A B$ (тогда считайте, что крепко связанные сны $A$ и $B$ больше не связаны)


Надеюсь, Ваши исследования кому-то помогут. Даже если не мне."

Входные данные

Первая строка входного файла содержит три целых числа, разделённые пробелами: $n (1≤n≤100000)
−$ количество снов, $m (0≤m≤100000) −$ количество связей между ними и $q (0≤q≤100000) −$
− количество запросов Рассказчика $((n+m)⋅q≤10^7)$.

Следующие $m$ строк задают связи между снами: $A_{i}, B_{i} -$ сны, связанные $i$-ой связью.

Далее следуют $q$ строк, описывающих запросы Рассказчика. В начале строки находится символ 
$t_{i} (? или -) −$ тип запроса, за которым следуют два числа $A, B (1≤A,B≤n)$.

* если $t_{1} = ?$, то необходимо вывести $YES$, если сны $A$ и $B$ связаны, иначе вывести $NO$.
* если $t_{1} = −$, то следует считать, что крепко связанные сны $A$ и $B$ больше не связаны.

Выходные данные

Для каждой операции $? A B$ во входном файле выведите на отдельной строке $YES$, если сны $A$ и $B$ связаны, иначе выведите $NO$.

# B. 3001: Галактическая Илиада
Сергей Кубик $−$ невероятно талантливый и изобретательный режиссёр, продюсер и сценарист, но у каждого творческого человека рано или поздно наступает момент, когда Муза его покидает, и наш герой не стал исключением.

И вот выдалась очередная бессонная ночь, Сергей стоит у окна и наблюдает за звёздами. Такими близкими, такими далёкими, такими родными и чужими одновременно. Невероятно, что наши предки смотрели на эти же звёзды. Они сравнивали их с драконами, пытались предсказывать по ним будущее. Эти мысли будоражили Сергея, и тут, словно вернувшись из длительного путешествия по соседним галактикам, к нему пришло то самое долгожданное вдохновение. Звезды и галактики $−$ то, чего ему так не хватало всё это время!

Художественные фильмы про мечтателей совсем не вписываются в его репертуар, нужно снимать документальный фильм про науку. Так и появился проект $ITMO 1900$. Учёные изучали образования новых галактик. В ходе исследований они обнаружили $n$ галактик, в каждой из которых была только одна звезда. В начале было непонятно, что будет с ними происходить, поэтому исследователи решили записывать больше данных о звёздах, а именно их яркость. Хранили они эти данные таким образом, что если пронумеровать все звёзды от $1$ до $n$, то для $i$-ой звезды мера её яркости равна $i$.

Шло время, и вдруг учёные заметили, что те самые $n$ галактик стали сталкиваться между собой, образуя новые, содержащие в себе все звёзды своих "родителей", да происходило всё это с такой скоростью, что даже яркость звёзд никак не изменялась со временем. Например, если в первой галактике находились звезды с яркостью $[1,2,4]$, во второй $— [3,6]$, а в третьей $— [7,9]$, то после столкновения первой галактики со второй их останется две: в первой будут звезды $[1,2,3,4,6]$, а во второй $— [7,9]$. После этого исследовали ввели меру яркости галактики, равной медианной яркости звезды в галактике. Для галактики $[1,2,3,4,6]$ эта мера равна $3$, а для $[7,9] — 7$.

Бешеная скорость образования новых галактик сильно мешала учёным: они не успевали проводить все необходимые замеры. Тут Сергей Кубик начал переживать, ведь без настоящего прорыва в исследованиях никто не станет смотреть его картину. Нельзя было упускать такой шанс, мир должен узнать о проекте $ITMO 1900$, и не просто от кого-то, а от Кубика! К режиссёру пришло озарение, необходимо пригласить в команду самых умных программистов, которые смогут смоделировать поведение галактик. Посоветовавшись с учёными, Сергей сформировал техническое задание для кандидатов. Вам необходимо быстро обрабатывать два типа запросов:

* $1$ $x$ $y$ (галактика, содержащая звезду яркости $x$, и галактика, содержащая звезду яркости $y$, сталкиваются)  
* $2$ $x$ (необходимо вывести яркость галактики, содержащей звезду с яркостью $x$)
Не упустите свой шанс попасть в кинофильм самого Сергея Кубика!

Входные данные

В первой строке входных данных расположены два целых числа $n$ и $q$ $(1≤n,q≤2⋅10^5) −$ количество звезд и количество запросов соответственно.

В каждой из следующих $q$ строк находится по одному запросу. В начале строки находится число $t_{i} (1≤t_{i}≤2) −$ тип запроса. Далее сам запрос:

* если $t_{1}=1$, то далее следуют два целых числа $x$ и $y$ $(1≤x,y≤n)$ — яркости звезд, которые находятся в столкнувшихся галактиках.

* если $t_{1}=2$, то далее следует целое число $x (1≤x≤n)$, которое обозначает, что необходимо вывести яркость галактики, содержащей звезду с яркостью $x$.


Выходные данные

Для каждого запроса типа $2 x$ выведите в отдельной строке число $−$ яркость галактики, содержащей звезду с яркостью $x$.

# C. Если я вас больше не увижу
Нам наскучило смотреть на актёров с их фальшивыми эмоциями. Мы устали от взрывов и спецэффектов. И хотя мир, в котором он живёт… в некотором смысле, подделка, в самом Трумане нет ничего фальшивого — никаких сценариев, и заготовок. Это не во всём Шекспир, но это всегда искренне. Это — жизнь.

Счастье быть страховым агентом в любимом городке Сихэвен!

Но у главного героя - Трумана, появились какие-то подозрения. А давайте посмотрим прямо в его голову. Там находится $n$ нейронных связей и $m$ синаптических путей. Каждый путь - принятие Труманом решение и преодоление психологических барьеров, с которыми от столкнулся, пытаясь отличить реальность от иллюзии. Чтобы пройти синаптический путь потребуется какое-то время.

Труман начинает своё психологическое путешествие от первой мысли (первая нейронная связь) до полного осознания (последняя нейронная связь), стремясь минимизировать время, затраченное на преодоление пути через эту сложную сеть решений.

Входные данные

Первая строка содержит два числа: количество нейронных связей $n$ и количество синаптических путей $m$ между ними $(1≤n≤10^5, 1≤m≤3⋅10^5)$.

Следующие $$m$ строк описывают синаптические пути: каждая строка содержит информацию о двух связях $a$ и $b$, соединённых синаптическим путём, и время прохождения $t (1≤a,b≤n, 1≤t≤10^6)$.

Выходные данные

Одно число — минимальное время, которое требуется Труману, чтобы пройти от начала его психологического путешествия к полному осознанию. Если осознание невозможно, выведите $−1$.

# D. You can, Ken!
Из реального мира, гласят кинохроники,
Барби бежала сначала на роликах,
Потом снегоход, фургон и ракета,
Велик, катер, машина и это,
Чтоб в Барбилэнд свой милый вернуться
И утром почти идеальной проснуться.

И рассказать подробно, детально:
«Ужас, кошмар и так, мол, и так,
Не представляете, миром реальным
Правят мужчины на лошадях!
Так справедливость может пропасть,
Ведь всё существует, как будто специально,
Чтобы удерживать эту власть.
А это не так уж и идеально».

Созвали съезд, провели конференцию.
Нет, не хотим «День Весны и Цветов».
Мы - разные Барби, из разных коллекций
Цвета волос, комплекций и наций,
Чтобы идеи внедрились в судьбе,
Провозглашаем хит из хитов:
«День солидарности женщин в борьбе
За Равноправие с Эмансипацией».

Решение в Барбилэнд по старинке
Предполагало и вечеринку.
Где же её теперь провести??
Так, ситуацию нужно спасти!
Домик Барби найти подходящий,
Чтобы праздник прошёл настоящий.

Кто разрешить задачу готов:
В городе в целом есть $N$ домов
И $M$ тропинок лежит между ними
(Барби там ходят ногами прямыми).
Нужно найти тот дом идеальный,
Чтобы рассчитан он был с минимальной
Суммой дорог до него (расстояний)
От всех существующих Барби-зданий.

Все напряглись, но один серфингист
Вызвался миру помочь! Супермен?
Нет, просто он еще программист,
И Барби сказала ему: ”You can, Ken!”

Входные данные

В первой строке даны два целых числа $N$ - количество Барби-домиков и $M$ - количество дорог между ними $(1≤N≤500; 0≤M≤500)$.

Далее следует $M$ строк с описанием дорог: $(x,y,l)$ - дорога длины $l (0≤l≤2^64)$, соединяющая домики $x$ и $y$ $(1≤x,y≤N)$.

Выходные данные

Выведите номер домика, в котором Барби следует провести вечеринку.

# E. Ничто нигде и никогда
Ты ведь тоже это ощущаешь? Будто всё не так... Одежда сидит совсем иначе на другой день и волосы не ложатся так, как тебе нравится. Даже кофе на вкус не тот. Наши основы разрушаются, мы уже не доверяем своим близким. А по ночам мы задаёмся одним вопросом: как всё вернуть?..

Но вернуть уже не получится. В нашем мире пустило корни великое зло и оно продолжает сеять хаос в других вселенных. Оказалось, что оно поглощает не только свет и материю. Оно может уничтожать целые миры и переходы между ними. Конец неизбежен... Ничто не имеет смысла...

Будет всего несколько коротких мгновений, когда хоть что-то важно. И вы хотите продлить это время. Для этого вам и вашим сокомандникам из альфа-мира необходимо поддерживать связь между оставшимися 
N
N вселенными. Многих из вас уже поглотила вечная пустота, поэтому контролировать все 
M
M переходов между мирами вы не сможете. Необходимо сконцентрироваться на тех переходах, потери которых нанесут больший ущерб, то есть при уничтожении которых пропадёт единственный возможный путь между двумя мирами.

Входные данные

В первой строке даны два целых числа 
N
N - количество миров и 
M
M - количество переходов между ними 
(
1
≤
N
≤
1
0
4
,
(1≤N≤10 
4
 , 
0
≤
M
≤
1
0
5
)
0≤M≤10 
5
 )

Далее следует 
M
M строк, содержащих пары миров 
(
x
,
y
)
(x,y), между которыми есть переход 
(
1
≤
x
,
y
≤
N
)
(1≤x,y≤N)

Выходные данные

Выведите все пары миров 
(
x
,
y
)
(x,y), переход между которыми будет охранять ваша команда 
(
x
i
≤
y
i
,
(x 
i
​
 ≤y 
i
​
 , 
x
i
≤
x
i
+
1
)
x 
i
​
 ≤x 
i+1
​
 ).

 # F. Сокровенные желания
Зона - это очень сложная система. Это огромный лабиринт внутри которого умрут все желания, и звучит лишь эхо тех, кто пытался проникнуть в его тайны. Здесь пути переплетаются и ведут в никуда, создавая вихрь событий и забывчивость даже у меня, а вы можете даже не надеяться.

Мы не то чтобы рискуем, отправившись вглубь Зоны, мы отдаём свою жизнь. Мы сталкиваемся с этими пространствами, где каждое место соединено с другим неким путем, и, кажется, что за каждым поворотом скрывается ответ, но на самом деле, здесь повсюду воронки, в которых время и пространство теряют свой смысл. Воронки это не одно место, а целая череда путей такая, что суммарная нормальность всех путей в воронке - отрицательна.

Вы вот говорите, что знаете физику? Эксперименты, факты, истина в последней инстанции. Да фактов вообще не бывает, а здесь и подавно. Здесь все кем-то выдумано. Все это чья-то идиотская выдумка. Неужели вы не чувствуете? А вам, конечно, до зарезу нужно знать, чья. Да почему? Что толку от ваших знаний? Чья совесть от них заболит? Моя?

Обругает какая-нибудь сволочь — рана. Другая сволочь похвалит — ещё рана. Душу вложишь, сердце своё вложишь — сожрут и душу, и сердце. Мерзость вынешь из души — жрут мерзость. Они же все поголовно грамотные, у них у всех сенсорное голодание. И все они клубятся вокруг — журналисты, редакторы, критики, бабы какие-то непрерывные. И все требуют: «Давай! Давай!..»

Нам пройти надо, а там воронки, представь себе идёшь ты вперёд, а возвращаешься обратно. Ещё одну карту не нарисуешь, придётся рисовать $N$ штук. Ну как рисовать, я только пути знаю, никто всю Зону знать не может. Это нам с вами ещё повезло, а вот стервятнику не повезло...

Слушайте внимательно. Не все воронки обойти получится, вот все которые меньше $k$ длиной - пройти сможем, иначе кранты. Я вам карты дам, вы записывайте главное, я буду называть сначала сколько точек на карте нарисовать, ну $n$ допустим, потом сколько путей $m$ рисовать будете, а потом сами пути называть, что-то вроде $u v h$, где $u$ и $v$ - номера точек на карте, которым можем пройти, а $h$ - их нормальность. Я как говорю путь, так вы и идите, в другую сторону нельзя, если не скажу. Вот как нарисуете все $N$ карт - внимательно посмотрите и скажите $YES$, если пройти сможем и $NO$, если не сможем.

И запомните, не на каждый ответ найдется вопрос, но место, куда мы идём... Пусть исполнится то, что задумано. Пусть они поверят. И пусть посмеются над своими страстями; ведь то, что они называют страстью, на самом деле не душевная энергия, а лишь трение между душой и внешним миром. А главное, пусть поверят в себя и станут беспомощными, как дети, потому что слабость велика, а сила ничтожна.

Входные данные

В первой строке два числа $1≤N≤1000, 0≤k≤N$.

Далее идёт $N$ блоков:

На первой строке блока два числа $1≤n≤10^5, 0≤m≤10^5$.

Следующие $n$ строк содержат по три числа: $1≤u≤n, 1≤v≤n, −10^6≤h≤10^6$

Выходные данные

Выведите $NO$ или $YES$.

# J. Начало или Конец
"Я не могу молчать! Всё вокруг кажется нереальным, но в то же время каким-то слишком настоящим. Кажется, я теряю себя. Я помню, как они пришли ко мне. Они спрашивали про сейф, какой-то сейф с деньгами или секретами, они говорили очень странно. Они хотят украсть у меня что-то, определённо. Говорили, что хотят помочь мне, но я им не верю. Ощущение того, что всё это сон, не покидает меня. Я хочу знать, так ли это, хочу понять, кому нужен это сейф, секрет, тайна, да что бы там ни было, на самом деле. Сам я не смогу остановить "их", мне нужна помощь. Я не знаю, к кому мне обратиться, никто же не поверит мне. А если это на самом деле сон, а они им каким-то образом управляют, они же не дадут мне узнать этого! Не позволят! Всё, что я могу сейчас сделать, это оставить свои записи. Может Вы, заинтересованный читатель, именно Вы, читая сейчас эти строки, поймёте, как помочь мне. Даже если со мной уже что-то случилось, может Вы обезопасите других. Вероятно, они могут навредить и другим. Мне нужно всё обдумать. Если это странное ощущение не пройдёт, я продолжу писать, лишь бы кто-то нашел мои записи, лишь бы это было не зря."

"Я не знаю, сколько времени прошло. Кажется, что я только-только отложил свой блокнот, но чернила от ручки выцвели так, словно кто-то оставил его раскрытым под палящим солнцем на месяц, не меньше! Такого же не происходит в жизни! Или я схожу с ума? Мне не стоит оставлять свои записи где попало, если их увидит кто-то "лишний", они всё поймут. Они поймут, что я всё знаю."

"Всё становится более странным и пугающим. Я проснулся. Всё, что было раньше, действительно было сном! Но хорошие новости на этом заканчиваются. Я проснулся в новом сне. Ощущение всё то же, поменялось только окружение, моя одежда, но это не по-настоящему. Я не помню, как вышел из предыдущего сна, поэтому не понимаю, как провернуть этот трюк вновь. Кажется, стоит как-то структурировать свои записи, чтобы по ним Вы смогли помочь мне разобраться со всем."

"Хочу договориться с Вами, дорогой читатель, каждый новый сон я буду обозначать числом $A$. Если есть такой сон, в который я проснулся из сна $A$, давайте мы назовём его $B$, то сны $A$ и $B$ будут крепко связаны между собой. Но пусть это работает в обе стороны, пусть как $A$ связано с $B$, так и $B$ связано с $A$. Если в записях вдруг будет какая-то цепочка из сна $C$ в сон $D$, то назовём такие сны просто связанными, не крепко. В случае моего примера со снами $A$ и $B$ они тоже просто связаны, крепкую связь будем считать частным случаем обычной связи. Что с этим делать, я пока не придумал. Напишу здесь позже."

"Ситуация не лучше. Ни капельки. Я начинаю путаться во снах. Кажется, что тот сон, из которого я проснулся в этот, был связан с каким-то другим. Точно не с этим. Кажется, я знаю какая помощь мне нужна от Вас. Я хочу структурировать все эти связи, распутать это непонятную паутину. Я хочу, чтобы Вы отвечали на запросы:

* $?$ $A$ $B$ тогда Вам нужно ответить, связаны ли сны $A$ и $B$)
* $−$ $A$ $B$ (тогда считайте, что крепко связанные сны $A$ и $B$ больше не связаны)
Надеюсь, Ваши исследования кому-то помогут. Даже если не мне."

Входные данные

Первая строка входного файла содержит три целых числа, разделённые пробелами: $n −$ количество снов, $m −$ количество связей между ними и $q −$ количество запросов Рассказчика (0≤n,m,q≤200000).

Следующие $m$ строк задают связи между снами: $A_{i}, B_{i} -$ сны, связанные $i$-ой связью.

Далее следуют $q$ строк, описывающих запросы Рассказчика. В начале строки находится символ $t_{i} (? или −) −$ тип запроса, за которым следуют два числа $A, B (1≤A,B≤n)$.

* если $t_{1} = ?$, то необходимо вывести $YES$, если сны $A$ и $B$ связаны, иначе вывести $NO$.  
* если $t_{1} = -$, то следует считать, что крепко связанные сны $A$ и $B$ больше не связаны.  


Выходные данные

Для каждой операции $? A B$ во входном файле выведите на отдельной строке $YES$, если сны $A$ и $B$ связаны, иначе выведите $NO$.